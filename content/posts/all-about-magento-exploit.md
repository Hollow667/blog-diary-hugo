---
title: 'All about Magento exploit'
date: 2016-04-19T20:40:00.000-07:00
draft: false
aliases: [ "/2016/04/all-about-magento-exploit.html" ]
tags : [Security]
---

[![](https://1.bp.blogspot.com/-0b7Q0JJAWbs/VTYUn8lZiyI/AAAAAAAAipA/OEJP6Vzhoxk/s1600/Magento-security.jpg)](http://1.bp.blogspot.com/-0b7Q0JJAWbs/VTYUn8lZiyI/AAAAAAAAipA/OEJP6Vzhoxk/s1600/Magento-security.jpg)

  
\[UPDATED 11:39 AM 5/27/2016\]  
  
Magento Scanner + Mass Exploiter PHP :  
[**KESINI**](http://blog.yuzaside.com/2016/05/magento-scanner-mass-exploiter-php.html)  
  
Dork :  
\- intext:/skin/adminhtml/default/default/  
\- intitle:computer inurl:account/login/ site:.com  
\- intitle:computer inurl:account/login/create/ site:.com  
\- intext:"2016" inurl:account/login site:.com  
\- "shirt" inurl:customer/account/login/ site:.com  
\- "jeans" inurl:account/login site:.com  
\- intitle:shop inurl:account/login/create site:.com  
\- intext:2016 inurl:customer/account/ site:.com  
\- ganti site, intitle dan intext dengan apa saja / use your brain !  
  
Ciri" cms magento :  
  

[![](https://2.bp.blogspot.com/-0EtSLJFNqlw/Vxb7lqrkyWI/AAAAAAAAAc4/EsFK-QmER1EvH4MZlnwvLNq_-d9VLyfjwCLcB/s640/magento.jpg.png)](https://2.bp.blogspot.com/-0EtSLJFNqlw/Vxb7lqrkyWI/AAAAAAAAAc4/EsFK-QmER1EvH4MZlnwvLNq_-d9VLyfjwCLcB/s1600/magento.jpg.png)

LETAK SMTP :  
\- system > configuration > view menu SMTP pro  
\- kalau ada SMTP PRO klik dan lihat username, password, port dan server nya  
\- kalau password masih bentuk \*\*\*\*\*\*\* ( inspect element > ganti value "password" dengan "text" )  
  

[![](https://1.bp.blogspot.com/-NbqNYYEDF2c/Vxb-JUUV4TI/AAAAAAAAAdE/JlwtEHrYMIQW72tzSfUVmPKhOwK7EnaigCLcB/s640/Screenshot_2.png)](https://1.bp.blogspot.com/-NbqNYYEDF2c/Vxb-JUUV4TI/AAAAAAAAAdE/JlwtEHrYMIQW72tzSfUVmPKhOwK7EnaigCLcB/s1600/Screenshot_2.png)

  
Upload shell :  
\- perlu di ketahui tidak semua bisa di tanam shell , atau jika sembarangan tanam shell webnya bakal error  
\- kalau vuln dan bisa di tanam shell pergi ke : system > file system > IDE > cari file > edit UPLOADER atau LANGSUNG EDIT SHELL di dalamnya > save > dan kunjungi file yang tadi di edit  
  
Ngelog PP&CC :  
\- tanem  shell dulu  
\- trus masuk ke /app/code/core/Mage/Payment/Model/Method/Cc.php  
\- masukin skrip logmu  
\- kalo bingung replace pake skripku, log v2  
\- cari kode ini $yuzamail = "eXV6YWMwZGVyQGFzaWEuY29t";  
\- ganti eXV6YWMwZGVyQGFzaWEuY29t sama emailmu, nanti log dikirim ksini (kalau web target support send mail) Cara test send mail ada di bawah..  
\- jgn lupa encript dulu dgn base64, bisa make punya si x'inject [disini](http://www.scriptencode.net/)  
  
  
  
  
Patching bug magento 1.7.0.2 :  
\- tanem shell dulu  
\- masuk ke /app/code/core/Mage/Catalog/Model/Product/Option/Type/File.php  
\- cari code ini:  

> protected function \_getOptionDownloadUrl($route, $params)  
> {  
>   
>    return Mage::getUrl($route, $params);  
> }

\- ganti dengan code ini:  

> protected function \_getOptionDownloadUrl($route, $params)  
> {  
>     $websites = Mage::app()->getWebsites();  
>     $code = $websites\[1\]->getDefaultStore()->getCode();  
>     $params\['\_store'\] = $code;  
>   
>     return Mage::getUrl($route, $params);  
> }

  
Cara Upload File System :  
\*Catatan: jika ada ketidak sesuaian/ditemukan error tdak sperti gambar yg saya sertakan brarti tidak bisa di upload file system!  
\- Download dulu file system [disini](http://adf.ly/1bO7FJ)  
Pass: yuzanotes.blogspot.co.id  
\- Masuk ke System > Magento Connect > Magento Connect Manager  

[![](https://1.bp.blogspot.com/-VMlRT5xd8rY/V0ZhATTmGVI/AAAAAAAAApc/XTHA2k3kEFIhhHNnf7cIY5KQ5XmOh1D8gCKgB/s640/Screenshot_61.png)](https://1.bp.blogspot.com/-VMlRT5xd8rY/V0ZhATTmGVI/AAAAAAAAApc/XTHA2k3kEFIhhHNnf7cIY5KQ5XmOh1D8gCKgB/s1600/Screenshot_61.png)

\- Jika Vuln maka akan muncul form login, jadi lu harus login ulang. Setelah login lu akan masuk ke halam ini, lihat gambar dibawah, dan upload file systemnya  

[![](https://2.bp.blogspot.com/-8QH4XKQWXnM/V0ZhAr65QxI/AAAAAAAAApw/2bE2gcDMz3sVOZ00-Y8e5iYW8YSArN3mwCKgB/s640/Screenshot_62.png)](https://2.bp.blogspot.com/-8QH4XKQWXnM/V0ZhAr65QxI/AAAAAAAAApw/2bE2gcDMz3sVOZ00-Y8e5iYW8YSArN3mwCKgB/s1600/Screenshot_62.png)

\- Nanti akan otomatis scrolling ke bawah sendiri dan jika sukses akan muncul notif seperti gambar dibawah  

[![](https://3.bp.blogspot.com/-g1uZG8vXNRY/V0abNk2ukmI/AAAAAAAAAqk/x2va7LJ98w8rlM9Q6vgKS80j1mUeyJ8rwCLcB/s640/Screenshot_63.png)](https://3.bp.blogspot.com/-g1uZG8vXNRY/V0abNk2ukmI/AAAAAAAAAqk/x2va7LJ98w8rlM9Q6vgKS80j1mUeyJ8rwCLcB/s1600/Screenshot_63.png)

\- Balik lagi ke dashboard admin, scrol ke atas ja terus klik Return to Admin  

[![](https://2.bp.blogspot.com/-hzh3_V5KoDc/V0ZhDri_6DI/AAAAAAAAAp0/ktLqSuQfq287tSOZiQ6Fbn7r8jQsPtoUwCKgB/s640/Screenshot_64.png)](https://2.bp.blogspot.com/-hzh3_V5KoDc/V0ZhDri_6DI/AAAAAAAAAp0/ktLqSuQfq287tSOZiQ6Fbn7r8jQsPtoUwCKgB/s1600/Screenshot_64.png)

\- Sekarang lihat file system udah terinstall. Dah sampe disini terserah mo diapain. Untuk cara upload shell baca lagi di atas dah jelas  

[![](https://2.bp.blogspot.com/-9_bfr1Qx0Kw/V0ZhBWlFRZI/AAAAAAAAAp0/DuAVmyb4FvQ8nfQcmodbK9mDuUsEpb6PwCKgB/s640/Screenshot_65.png)](https://2.bp.blogspot.com/-9_bfr1Qx0Kw/V0ZhBWlFRZI/AAAAAAAAAp0/DuAVmyb4FvQ8nfQcmodbK9mDuUsEpb6PwCKgB/s1600/Screenshot_65.png)

  
Email Test Sender :  
\- Harus nanem shell dulu, gak tau caranya? baca lagi dari atas  
\- Taruh script di bawah terserah d taruh mana..  
  
  
  
\- Setelah itu buka lewat url, jika support kirim email akan nampak seperti gambar dibawah  

[![](https://3.bp.blogspot.com/-NqnahHlhQt0/V0fKWRmDNgI/AAAAAAAAArQ/BckB5BT2k-E82px6LKToDeW8wucUleKkwCLcB/s640/Screenshot_78.png)](https://3.bp.blogspot.com/-NqnahHlhQt0/V0fKWRmDNgI/AAAAAAAAArQ/BckB5BT2k-E82px6LKToDeW8wucUleKkwCLcB/s1600/Screenshot_78.png)

\- Masuk inbox nih :D  

[![](https://2.bp.blogspot.com/-CW_TqK1Ju_w/V0fKYibD0VI/AAAAAAAAArU/lspMVnDKCv0H1gB1m4cJRGE6T_9wjdsrACKgB/s640/Screenshot_79.png)](https://2.bp.blogspot.com/-CW_TqK1Ju_w/V0fKYibD0VI/AAAAAAAAArU/lspMVnDKCv0H1gB1m4cJRGE6T_9wjdsrACKgB/s1600/Screenshot_79.png)

[![](https://2.bp.blogspot.com/-NRryR8x3P0k/V0fKYutry-I/AAAAAAAAArY/Ag0_V8Xx-yAPwepp18neSIi-PGQafposgCKgB/s640/Screenshot_80.png)](https://2.bp.blogspot.com/-NRryR8x3P0k/V0fKYutry-I/AAAAAAAAArY/Ag0_V8Xx-yAPwepp18neSIi-PGQafposgCKgB/s1600/Screenshot_80.png)

  

  
Semoga bermanfaat :)